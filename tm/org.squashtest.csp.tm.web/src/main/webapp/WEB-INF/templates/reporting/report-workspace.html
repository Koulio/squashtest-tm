<!--

        This file is part of the Squashtest platform.
        Copyright (C) 2010 - 2011 Squashtest TM, Squashtest.org

        See the NOTICE file distributed with this work for additional
        information regarding copyright ownership.

        This is free software: you can redistribute it and/or modify
        it under the terms of the GNU Lesser General Public License as published by
        the Free Software Foundation, either version 3 of the License, or
        (at your option) any later version.

        this software is distributed in the hope that it will be useful,
        but WITHOUT ANY WARRANTY; without even the implied warranty of
        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
        GNU Lesser General Public License for more details.

        You should have received a copy of the GNU Lesser General Public License
        along with this software.  If not, see <http://www.gnu.org/licenses/>.

-->
<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring3-3.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
	<title th:text="#{workspace.report.title}">Espace rapports</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- common head -->
	<link rel="stylesheet" type="text/css" media="all" href="../../../../../../../../core/core.web/src/main/webapp/styles/master.css" th:href="@{/styles/master.css}" />
	<!-- /common head -->
	<!-- common script import -->
	<link rel="stylesheet" type="text/css" media="all" href="../../../../../../../../core/core.web/src/main/webapp/styles/squashtm.fg.menu.css" th:href="@{/styles/squashtm.fg.menu.css}" />
	<!-- /common script import -->
	<link rel="stylesheet" type="text/css" media="all" href="../../../../../../../../core/core.web/src/main/webapp/styles/master.blue.css" th:href="@{/styles/master.blue.css}" />
	<!-- rich jeditable header -->
	<link rel="stylesheet" type="text/css" media="all" href="../../../../../../../../core/core.web/src/main/webapp/styles/ckeditor.override.css" th:href="@{/styles/ckeditor.override.css}" />
	
</head>
<body>
	<!-- /navigation tag -->
	<div id="navigation">
		<div id="test_mgt_nav">
			<a id="home-link" class="nav_btn" href="home-workspace.html" th:href="@{/home-workspace}">
				<img src="../../../images/Button_Nav_Home_off.png" 
					th:src="@{/images/Button_Nav_Home_off.png}" 
					th:alt="#{workspace.home.button.label}" 
					th:title="#{workspace.home.button.label}" 
				/>
			</a>
			<a id="requirement-link" class="nav_btn" href="requirement-workspace.html" th:href="@{/requirement-workspace}">
				<img src="../../../images/Button_Nav_Requirement_off.png" 
					th:src="@{/images/Button_Nav_Requirement_off.png}" 
					th:alt="#{workspace.requirement.button.label}" 
					th:title="#{workspace.requirement.button.label}" 
				/>
			</a>
			<a id="test-case-link" class="nav_btn" href="test-case-workspace.html" th:href="@{/test-case-workspace}">
				<img src="../../../images/Button_Nav_TestCase_off.png" 
					th:src="@{/images/Button_Nav_TestCase_off.png}" 
					th:alt="#{workspace.test-case.button.label}" 
					th:title="#{workspace.test-case.button.label}" 
				/>
			</a>
			<a id="campaign-link" class="nav_btn" href="campaign-workspace.html" th:href="@{/campaign-workspace}">
				<img src="../../../images/Button_Nav_Campaign_off.png" 
					th:src="@{/images/Button_Nav_Campaign_off.png}" 
					th:alt="#{workspace.campaign.button.label}" 
					th:title="#{workspace.campaign.button.label}" 
				/>
			</a>
			<a id="report-link" class="nav_btn" href="report-workspace.html" th:href="@{/report-workspace}">
				<img src="../../../images/Button_Nav_Reporting_off.png" 
					th:src="@{/images/Button_Nav_Reporting_off.png}" 
					th:alt="#{workspace.report.button.label}" 
					th:title="#{workspace.report.button.label}" 
				/>
			</a>
		</div>
		
		<div id="nav_logo" class="nav_btn">
			<img src="../../../../../../../../core/core.web/src/main/webapp/images/logo_squash30.png" th:src="@{/images/logo_squash30.png}" alt="Logo Squash" />
		</div>
	</div>
	<!-- /navigation tag -->

	<div id="workspace">
		<div id="workspace-title">
			<div class="snap-left">
				<h2 th:text="#{workspace.report.title}">Espace Rapport</h2>	
			</div>
			<div class="snap-right">
				<div style="display:inline-block;">
<!--
 					<layout:_ajax-notifications  cssClass="snap-right"/>
 -->
 				</div>
 				<div class="main-menubar">
					<!-- >layout:_menu-bar /-->
					<div>
						<input type="checkbox" id="menu-toggle-filter-ckbox"></input>
						<a id="menu-project-filter-link" href="javascript:void(0)" >Inactif</a> 
					</div>

					<div th:if="${sec.hasRole('ROLE_TM_PROJECT_MANAGER')} or ${sec.hasRole('ROLE_ADMIN')}">
						<a id="menu-administration-link" 
							href="administration.html" th:href="@{/administration}" 
							th:text="#{workspace.menubar.administration.label}">
							Administration
						</a>
					</div>
					<div>
						<a id="menu-account-link" href="user-account.html" th:href="@{/user-account}">
							<span th:text="#{workspace.menubar.account.label}"/>Mon compte</span>&nbsp;(<span th:text="${sec.authentication.name}">Zoltan</span>)
						</a>
					</div>
					<div th:if="${sec.isAuthenticated()}">
						<a id="menu-logout-link" href="logout.html" th:href="@{/logout}" th:text="#{workspace.menubar.logout.label}">logout</a>
					</div>
					
					<!-- comp:settings-project-filter-popup divId="project-filter-popup" openedBy="menu-project-filter-link"/-->
					<!-- 
						yeees that one is not contextual. Set it to true and the damn dialog will get wiped by any tree action. 	
					-->
					<div id="project-filter-popup" class="popup-dialog">
						<div class="project-item-template not-displayed">
							<div class="project-item ">
								<input type="checkbox" class="project-checkbox"/> <span class="project-name"></span>
							</div>
						</div>
						<div id="dialog-settings-filter-maincontent">			
							<div id="dialog-settings-filter-controls" class="project-filter-controls">
								<a id="dialog-settings-filter-selectall" href="javascript:void(0)" th:text="#{dialog.settings.filter.controls.selectall}">
									Select all
								</a>
								<a id="dialog-settings-filter-deselectall" href="javascript:void(0)" th:text="#{dialog.settings.filter.controls.deselectall}">
									Unselect all
								</a>
								<a id="dialog-settings-filter-invertselect" href="javascript:void(0)" th:text="#{dialog.settings.filter.controls.invertselect}">
									Invert sel
								</a>				
							</div>	
							<hr/>
							<div id="dialog-settings-filter-projectlist" class="project-filter-list">
							
							</div>
						
							<div style="clear:both;display:hidden;"></div>
						</div>
					</div>
					<!-- /comp:settings-project-filter-popup divId="project-filter-popup" openedBy="menu-project-filter-link"/-->
						
						
					<!-- >layout:_menu-bar /-->
				</div>
			
			</div>
		</div>
		<div id="category-pane">
<!--
 			<comp:category-panel categories="${categories}" />
 -->
 		</div>
		<div id="contextual-content" class="no-resizable-contextual-content">
			<span th:remove="all">This area will be populated on demand later</span>
		</div>
	</div>

	<!-- common script import -->
	<!-- jq header -->
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/jquery/jquery-1.5.2-dev.js" th:src="@{/scripts/jquery/jquery-1.5.2.min.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/jquery/jquery-ui-1.8.13.all.dev.js" th:src="@{/scripts/jquery/jquery-ui-1.8.13.custom.min.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/jquery.squashtm.plugin.js" th:src="@{/scripts/squashtest/jquery.squashtm.plugin.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/jquery.squashtm.togglepanels.js" th:src="@{/scripts/squashtest/jquery.squashtm.togglepanels.js}"></script> 
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/jquery.squash.messagedialog.js" th:src="@{/scripts/squashtest/jquery.squash.messagedialog.js}"></script>  
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/jquery.squash.confirmdialog.js" th:src="@{/scripts/squashtest/jquery.squash.confirmdialog.js}"></script>  
	<!-- /jq header -->
	<!-- ckeditor import -->
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/ckeditor/ckeditor.js" th:src="@{/scripts/ckeditor/ckeditor.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/ckeditor/adapters/jquery.js" th:src="@{/scripts/ckeditor/adapters/jquery.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/jquery/jquery.dialog-patch.js" th:src="@{/scripts/jquery/jquery.dialog-patch.js}"></script>
	<!-- /ckeditor import -->	
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/jquery.squashtm.oneshotdialog.js" th:src="@{/scripts/squashtest/jquery.squashtm.oneshotdialog.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/classes/KeyEventListener.js" th:src="@{/scripts/squashtest/classes/KeyEventListener.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/jquery.squashtm.contextual-content.js" th:src="@{/scripts/squashtest/jquery.squashtm.contextual-content.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/jquery.squashtm.fg.menu.js" th:src="@{/scripts/squashtest/jquery.squashtm.fg.menu.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/classes/Event.js" th:src="@{/scripts/squashtest/classes/Event.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/jquery.squash.squashbutton.js" th:src="@{/scripts/squashtest/jquery.squash.squashbutton.js}"></script>
	<!-- /common script import -->
	<!-- rich jeditable -->
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/jquery/jquery.jeditable.js" th:src="@{/scripts/jquery/jquery.jeditable.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/jquery/jquery.generateId.js" th:src="@{/scripts/jquery/jquery.generateId.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/jquery/jquery.jeditable.ckeditor.js" th:src="@{/scripts/jquery/jquery.jeditable.ckeditor.js}"></script>
	<script type="text/javascript" src="../../../../../../../../core/core.web/src/main/webapp/scripts/squashtest/jquery.squashtm.jeditable.ext.js" th:src="@{/scripts/squashtest/jquery.squashtm.jeditable.ext.js}"></script>
	<!-- menubar -->	
	<script type="text/javascript" src="../../../scripts/squash/squashtm.menubar.js" th:src="@{/scripts/squashtest/squashtm.menubar.js}"></script>

	<script th:remove="all" type="text/javascript" src="../../../js/thymol.js"></script>
	<script type="text/javascript" src="../../../scripts/squash/squashtm.navbar.js" th:src="@{/scripts/squash/squashtm.navbar.js}"></script>
	<script type="text/javascript" src="../../../scripts/squash/squashtm.projectfilter.js" th:src="@{/scripts/squash/squashtm.projectfilter.js}"></script>

	<script type="text/javascript">
		var reportWorkspace = (function($) {
			<!-- script managing the expand/normal state of this part of the workspace -->

			function setEditReportNormalState(){
				$("#contextual-content").removeClass("expanded");
			}
			
			function setEditReportExpandState(){
				$("#contextual-content").addClass("expanded");
			}
			
			function toggleEditReportState(){
				$("#contextual-content").toggleClass("expanded");
			}
			
			return {
				/**
					the function regarding the category panel are defined in edit-report.jsp,
					because the button managing it is there too.
					
					If that's too confusing consider refractoring some day.
				*/
	
				setReportWorkspaceNormalState : function() {
					setCategoryFrameNormalState();
					setEditReportNormalState();
				},
				
				setReportWorkspaceExpandState : function() {
					setCategoryFrameExpandState();
					setEditReportExpandState();
				},
				
				toggleReportWorkspaceState : function (){
					toggleCategoryFrameState();
					toggleEditReportState();							
				}
			}
		}(jQuery));

		$(function() {
			<!-- navigation tag -->
			squashtm.navbar.initHighlighted('report');
			
			<!-- decorate buttons -->
			$.squash.decorateButtons();
			
			<!-- project filter -->
			var projectFilterConf = {
					url: /* [[@{/global-filter/filter}]] */ '/global-filter/filter',
					title : /* [[#{dialog.settings.filter.title}]] */ 'Filtre de projets',
					confirmLabel: /* [[#{dialog.button.confirm.label}]] */ 'Confirmer',
					cancelLabel: /* [[#{dialog.button.cancel.label}]] */ 'Annuler',
			}
				
			squashtm.projectfilter.init(projectFilterConf);
			
			<!-- menubar -->
			var menuBarConf = {
				boxSelector : "#menu-toggle-filter-ckbox",
				url : /* [[@{/global-filter/filter-status}]] */ '/global-filter/filter-status',
				linkSelector : "#menu-project-filter-link",
				enabledTxt : /* [[#{workspace.menubar.filter.enabled.label}]] */ 'Actif',
				disabledTxt : /* [[#{workspace.menubar.filter.disabled.label}]] */ 'Inactif',
				enabledCallbacks : [ function(){ $("div.tree-filter-reminder-div > span").removeClass("not-displayed");} ]
			}
	
			squashtm.menubar.init(menuBarConf);
		});	
	</script>
</body>
</html>